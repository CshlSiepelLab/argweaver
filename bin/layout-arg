#!/usr/bin/env python

import optparse
import sys

import arghmm
import arghmm.vis

from rasmus import util


o = optparse.OptionParser(
    usage="%prog SMC_FILE",
    description="""
Write out layout for ARG stored in *.smc format
""")

conf, args = o.parse_args()


# Parse arguments
if len(args) == 0:
    o.print_help()
    sys.exit(1)

for smc_file in args:
    smc = arghmm.SMCReader(smc_file, parse_trees=True)
    chrom = smc.header["chrom"]
    names = smc.header["names"]

    for block, tree_layout in arghmm.vis.iter_layout_smc(
            smc, names=names):
        row = [chrom, block[0] + 1, block[1]]
        for name in names:
            row.extend([name, tree_layout[name]])
        util.print_row(*row)
