#!/usr/bin/env python

import optparse
import sqlite3  as sqlite

from rasmus.common import *
import arghmm
from arghmm.db import SitesDB

o = optparse.OptionParser()
o.add_option("-d", "--db")
o.add_option("", "--add-sites", action="append", default=[])

conf, args = o.parse_args()

#=============================================================================



db = SitesDB().connect(conf.db)

for fn in conf.add_sites:
    sites_it = arghmm.iter_sites(fn)
    header = sites_it.next()
    db.add_sites(header["chrom"], sites_it)

db.commit()
db.close()
